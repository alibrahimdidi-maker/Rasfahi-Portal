<!DOCTYPE html>
<html lang="dv" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presidential Suite v4</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Royal Font Setup */
        @font-face { font-family: 'Faruma'; src: local('Faruma'), local('MV Boli'); }
        
        :root {
            --royal-bg: #000a16;
            --royal-accent: #d4af37;
            --glass-gold: rgba(212, 175, 55, 0.1);
            --pure-white: #ffffff;
            --support-col: #d4af37;
            --vote-col: #1a5e1a;
        }

        body {
            font-family: 'Faruma', sans-serif;
            background-color: var(--royal-bg);
            color: var(--pure-white);
            margin: 0;
            transition: all 0.5s ease;
        }

        /* Presidential Theme Engine - Sample of the 50 Themes logic */
        .theme-1 { --royal-bg: #000a16; --royal-accent: #d4af37; }
        .theme-2 { --royal-bg: #1a0000; --royal-accent: #ff4d4d; }
        .theme-3 { --royal-bg: #001a00; --royal-accent: #00ff00; }
        /* JS adds more dynamic themes up to 50 */

        .main-header {
            background: linear-gradient(180deg, rgba(0,0,0,0.8), transparent);
            border-bottom: 2px gold solid;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }

        .royal-card {
            background: var(--glass-gold);
            border: 1px solid var(--royal-accent);
            border-radius: 15px;
            padding: 20px;
            margin: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }

        .btn-presidential {
            background: linear-gradient(145deg, var(--royal-accent), #8a6d1d);
            color: #000;
            border: 1px solid #fff;
            padding: 12px 25px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 0 4px 0 #5e4a13;
            transition: 0.2s;
        }

        .btn-presidential:active { transform: translateY(3px); box-shadow: none; }

        /* Responsive Grid */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        /* Mobile View Optimization */
        @media (max-width: 768px) {
            .hide-mobile { display: none; }
            .voter-item { display: block; background: #fff; color: #000; margin-bottom: 10px; padding: 15px; border-radius: 10px; border-left: 5px solid var(--royal-accent); }
            .btn-status { width: 100%; margin-top: 10px; height: 50px; }
            .main-header h1 { font-size: 1.5rem; }
        }

        table { width: 100%; border-collapse: collapse; background: white; color: black; border-radius: 10px; overflow: hidden; }
        th { background: #001a33; color: var(--royal-accent); padding: 15px; }
        td { border-bottom: 1px solid #eee; padding: 12px; text-align: center; }

        .active-yes { background: var(--support-col) !important; color: white; }
        .active-no { background: #ff4444 !important; color: white; }
    </style>
</head>
<body onbeforeunload="return 'ﬁâﬁ¶ﬁ¢ﬁ™ﬁçﬁ´ﬁâﬁßﬁåﬁ™ ﬁêﬁ≠ﬁàﬁ∞ﬁÜﬁ™ﬁÉﬁ¨ﬁáﬁ∞ﬁàﬁ®ﬁÇﬁ∞ﬁåﬁØÿü'">

<div class="main-header">
    <h1 id="txt-title" style="letter-spacing: 5px; font-size: 3rem; margin: 0;">PRESIDENTIAL SUITE</h1>
    <div style="margin-top: 20px;">
        <input type="text" id="off-name" placeholder="ﬁáﬁÆﬁäﬁ©ﬁêﬁ∞ ﬁÇﬁ¶ﬁÇﬁ∞" class="royal-card" style="color:white; width: 200px;">
        <input type="text" id="st-name" placeholder="ﬁâﬁ¶ﬁÉﬁ™ﬁÜﬁ¶ﬁíﬁ™" class="royal-card" style="color:white; width: 200px;">
    </div>
    
    <div style="margin: 20px;">
        <button class="btn-presidential" onclick="setLang('dv')">ﬁãﬁ®ﬁàﬁ¨ﬁÄﬁ®</button>
        <button class="btn-presidential" onclick="setLang('en')">ENGLISH</button>
        <select id="themeSelect" onchange="applyTheme(this.value)" class="btn-presidential">
            </select>
    </div>
</div>

<div class="stats-container">
    <div class="royal-card"><canvas id="chartSupport"></canvas></div>
    <div class="royal-card"><canvas id="chartVote"></canvas></div>
</div>

<div class="royal-card" style="margin: 20px; text-align: center;">
    <button class="btn-presidential" onclick="importVoters()">CSV ﬁáﬁ®ﬁâﬁ∞ﬁïﬁØﬁìﬁ∞</button>
    <button class="btn-presidential" onclick="downloadHugeDummy()">2000 ﬁëﬁ¶ﬁâﬁ© ﬁÇﬁ¶ﬁÇﬁ∞ﬁÑﬁ¶ﬁÉﬁ™ ﬁëﬁ¶ﬁáﬁ™ﬁÇﬁ∞ﬁçﬁØﬁëﬁ∞</button>
    <button class="btn-presidential" onclick="window.print()">ﬁÉﬁ®ﬁïﬁØﬁìﬁ∞ / PDF</button>
    <br><br>
    <label>ﬁäﬁ¶ﬁÉﬁ™ﬁâﬁß ﬁäﬁÆﬁÇﬁ∞ﬁìﬁ∞ ﬁäﬁ¶ﬁáﬁ®ﬁçﬁ∞ (ﬁçﬁØﬁÜﬁ¶ﬁçﬁ∞): </label>
    <input type="file" id="fontUpload" accept=".ttf,.woff2" onchange="loadLocalFont(this)">
</div>

<div id="voter-display" style="padding: 20px;">
    </div>

<script>
    let voters = JSON.parse(localStorage.getItem('royal_v4_data')) || [];
    let curLang = 'dv';

    // 50 Royal Themes Generator
    const themes = [];
    for(let i=0; i<50; i++){
        themes.push({ name: `Royal Theme ${i+1}`, bg: `hsl(${i*15}, 50%, 5%)`, acc: `hsl(${i*15}, 70%, 50%)` });
    }

    function initThemes() {
        const sel = document.getElementById('themeSelect');
        themes.forEach((t, i) => {
            let opt = new Option(t.name, i);
            sel.add(opt);
        });
    }

    function applyTheme(idx) {
        const t = themes[idx];
        document.documentElement.style.setProperty('--royal-bg', t.bg);
        document.documentElement.style.setProperty('--royal-accent', t.acc);
        document.documentElement.style.setProperty('--support-col', t.acc);
    }

    function setLang(l) {
        curLang = l;
        document.body.dir = (l === 'dv') ? 'rtl' : 'ltr';
        document.getElementById('txt-title').innerText = (l === 'dv') ? 'ﬁùﬁßﬁÄﬁ© ﬁáﬁ®ﬁÇﬁ∞ﬁåﬁ®ﬁöﬁßﬁÑﬁ© ﬁâﬁ¶ﬁÉﬁ™ﬁÜﬁ¶ﬁíﬁ™' : 'PRESIDENTIAL SUITE';
        renderVoters();
    }

    function downloadHugeDummy() {
        let csv = "No,Name,ID,Address,Station,Phone1\n";
        const firstNames = ["Ahmed", "Mohamed", "Ali", "Ibrahim", "Hassan", "Aishath", "Mariyam", "Aminath", "Fathimath"];
        const lastNames = ["Rasheed", "Shareef", "Nasir", "Zaki", "Saeed", "Nazeer", "Farih"];
        
        for(let i=1; i<=2000; i++) {
            let name = firstNames[Math.floor(Math.random()*9)] + " " + lastNames[Math.floor(Math.random()*7)] + " " + i;
            csv += `${i},${name},A${100000+i},H. Sample ${i},Center ${Math.ceil(i/100)},77${Math.floor(10000+Math.random()*90000)}\n`;
        }
        const blob = new Blob([csv], { type: 'text/csv' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "2000_Voters_List.csv";
        a.click();
    }

    function loadLocalFont(input) {
        const file = input.files[0];
        const reader = new FileReader();
        reader.onload = (e) => {
            const newFont = new FontFace('Faruma', e.target.result);
            newFont.load().then((loaded) => {
                document.fonts.add(loaded);
                document.body.style.fontFamily = 'Faruma';
            });
        };
        reader.readAsArrayBuffer(file);
    }

    function renderVoters() {
        const container = document.getElementById('voter-display');
        let html = '';
        
        if(window.innerWidth > 768) {
            html = `<table><thead><tr><th>#</th><th>ﬁÇﬁ¶ﬁÇﬁ∞ / Name</th><th>ID</th><th>Station</th><th>Support</th><th>Vote</th></tr></thead><tbody>`;
            voters.forEach((v, i) => {
                html += `<tr>
                    <td>${i+1}</td>
                    <td>${v.name}</td>
                    <td>${v.id}</td>
                    <td>${v.station}</td>
                    <td>
                        <button class="btn-presidential ${v.sup==='y'?'active-yes':''}" onclick="updateV(${i},'sup','y')">üëç</button>
                        <button class="btn-presidential ${v.sup==='n'?'active-no':''}" onclick="updateV(${i},'sup','n')">üëé</button>
                    </td>
                    <td onclick="updateV(${i},'vote',!v.vote)">${v.vote?'‚úÖ':'üó≥Ô∏è'}</td>
                </tr>`;
            });
            html += `</tbody></table>`;
        } else {
            voters.forEach((v, i) => {
                html += `<div class="voter-item">
                    <b>${v.name}</b><br><small>${v.id} | ${v.station}</small>
                    <div style="display:flex; gap:5px; margin-top:10px;">
                        <button class="btn-presidential ${v.sup==='y'?'active-yes':''}" onclick="updateV(${i},'sup','y')">üëç</button>
                        <button class="btn-presidential ${v.sup==='n'?'active-no':''}" onclick="updateV(${i},'sup','n')">üëé</button>
                        <button class="btn-presidential" style="flex-grow:1" onclick="updateV(${i},'vote',!v.vote)">${v.vote?'ﬁàﬁØﬁìﬁ™ﬁçﬁ¶ﬁáﬁ®ﬁäﬁ®':'ﬁàﬁØﬁìﬁ™ ﬁÇﬁ™ﬁçﬁß'}</button>
                    </div>
                </div>`;
            });
        }
        container.innerHTML = html;
        updateCharts();
    }

    function updateV(i, key, val) {
        voters[i][key] = val;
        localStorage.setItem('royal_v4_data', JSON.stringify(voters));
        renderVoters();
    }

    let sChart, vChart;
    function updateCharts() {
        const y = voters.filter(v=>v.sup==='y').length;
        const n = voters.filter(v=>v.sup==='n').length;
        const v = voters.filter(v=>v.vote).length;

        if(!sChart) {
            sChart = new Chart(document.getElementById('chartSupport'), { type: 'bar', data: { labels: ['Yes', 'No'], datasets: [{data:[y,n], backgroundColor:['gold','red']}] }, options: {plugins:{legend:{display:false}}, scales:{y:{ticks:{color:'#fff'}}}} });
            vChart = new Chart(document.getElementById('chartVote'), { type: 'pie', data: { labels: ['Voted', 'Not'], datasets: [{data:[v, voters.length-v], backgroundColor:['green','#222']}] } });
        } else {
            sChart.data.datasets[0].data = [y, n]; sChart.update();
            vChart.data.datasets[0].data = [v, voters.length-v]; vChart.update();
        }
    }

    window.onload = () => { initThemes(); setLang('dv'); };
    window.onresize = renderVoters;
</script>

</body>
</html>
